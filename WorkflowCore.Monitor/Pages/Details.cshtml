@page "/workflows/details/{id?}"
@model WorkflowCore.Monitor.Pages.DetailsModel
@{
    ViewData["Title"] = "Workflow Instance Details";
}

<h1>Workflow Instance Details</h1>

<div>
    <h4>Instance ID: @Model.Instance.Id</h4>
    <hr />
    <dl class="row">
        <dt class="col-sm-3">Workflow Definition:</dt>
        <dd class="col-sm-9">@Model.Instance.WorkflowDefinitionId v@(Model.Instance.Version)</dd>

        <dt class="col-sm-3">Status:</dt>
        <dd class="col-sm-9">@Model.Instance.Status</dd>

        <dt class="col-sm-3">Created:</dt>
        <dd class="col-sm-9">@Model.Instance.CreateTime</dd>

        <dt class="col-sm-3">Completed:</dt>
        <dd class="col-sm-9">@(Model.Instance.CompleteTime?.ToString() ?? "Not completed")</dd>

        <dt class="col-sm-3">Current Step:</dt>
        <dd class="col-sm-9">@Model.Instance.NextExecution</dd>
    </dl>
</div>

<h3>Execution Pointer History</h3>
<table class="table table-striped">
    <thead>
        <tr>
            <th>Step</th>
            <th>Status</th>
            <th>Start Time</th>
            <th>End Time</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var pointer in Model.Instance.ExecutionPointers.OrderBy(p => p.StartTime))
        {
            <tr>
                <td>@pointer.StepId</td>
                <td>@(pointer.Active ? "Active" : pointer.EndTime.HasValue ? "Complete" : "Pending")</td>
                <td>@(pointer.StartTime.HasValue? pointer.StartTime.Value.ToString() : "-")</td>
                <td>@(pointer.EndTime.HasValue? pointer.EndTime.Value.ToString() : "-")</td>
            </tr>
        }
    </tbody>
</table>

<div>
    <a asp-page="./Index" class="btn btn-secondary">Back to List</a>
</div>